options.disp_currency_fmt = '%.05f'
options.disp_float_fmt = '{:.05f}'
options.quitguard = True

import datetime

def type_timedelta(value):
    return datetime.timedelta(milliseconds=int(value))

def type_datetime(value):
    nsk_timezone = datetime.timezone(datetime.timedelta(hours=7), name='Asia/Novosibirsk')
    return datetime.datetime.fromtimestamp(int(value) / 1000).astimezone(nsk_timezone)

vd.addType(type_timedelta, icon='d')
vd.addType(type_datetime, icon='D')

TableSheet.addCommand('1', 'type-datetime', 'cursorCol.type=type_datetime')
TableSheet.addCommand('2', 'type-timedelta', 'cursorCol.type=type_timedelta')
